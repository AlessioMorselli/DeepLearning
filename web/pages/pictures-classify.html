<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Deep Learning - Riconoscimento di Immagini</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- framework - Da condividere -->
    <link href="framework/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="framework/js/bootstrap.min.js"></script>
    
    <!-- css comune -->
    <link href="css/style.css" rel="stylesheet">
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments);},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m);
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3698471-21', 'stanford.edu');
      ga('send', 'pageview');

    </script>

    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/vis.js"></script>
    <script src="js/util.js"></script>
    <script src="js/convnet.js"></script>

    <script src="js/cifar10_labels.js"></script>
    <script src="js/pictures-classify.js"></script>
  </head>
  <body>
    <div id="wrap" class="container">
      
      <!-- Header -->
      <div>
        <h1 style="text-align: center">
          <a href="home.html">
            DEEP LEARNING
          </a>
        </h1>
        <nav class="navbar navbar-default">
          <ul class="nav navbar-nav" style="float: none;">
            <li class="dropdown item-list">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                aria-expanded="false">Esempi <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="MNIST-classify.html">Riconoscimento Cifre</a></li>
                <li><a href="data-classify.html">Classificazione di Dati</a></li>
                <li><a href="pictures-classify.html">Riconoscimento Immagini</a></li>
                <li><a href="reinforcement.html">Reinforcement Learning</a></li>
              </ul>
            </li>
            <li class="dropdown item-list">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                aria-expanded="false">Approfondimenti <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="overfitting.html">Overfitting</a></li>
                <li><a href="training-difficulty.html">Difficoltà di Allenamento</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="weight-bias-init.html">Inizializzazione dei Parametri</a></li>
                <li><a href="regularization.html">Regolarizzazione</a></li>
                <li><a href="hyper-param.html">Scelta dei Parametri Secondari</a></li>
              </ul>
            </li>
            <li class="item-list">
              <a href="frontiere.html">Frontiere</a>
            </li>
            <li class="item-list">
              <a href="in-futuro.html">Cosa ci aspetta in futuro?</a>
            </li>
          </ul>
        </nav>
      </div>
      <!-- Header - FINE -->
      
      <h1 class="centrato">Riconoscimento di Immagini</h1>
      
      <p class="centrato">Le reti neurali permettono di svolgere un gran numero di compiti. In questa demo,
        daremo ad una rete neurale il compito di classificare delle immagini in base al loro contenuto.</p>
      
      <p class="centrato">Innanzitutto, cominciamo descrivendo il set di immagini che useremo: è il <b>CIFAR-10</b>,
        un database di immagini che ne contiene 60.000, a colori e di una risoluzione pari a 32x32. Il set è
        diviso in 50.000 immagini di allenamento e 10.000 di test. Inoltre, ad ogni immagine è sta assegnata
        una classe, tra 10 disponibili: aeroplani (airplane), automobili (automobile), uccelli (bird), gatti
        (cat), cervi (deer), cani (dog), rane (frog), cavalli (horse), navi (ship), camion (truck). Queste
        10 classi sono completamente separate e tutte le immagini appartengono esclusivamente ad una e una
        sola classe.</p>
      
      <div class="figura">
        <img src="documentation/dog4.png">
        <img src="documentation/airplane4.png">
        <img src="documentation/automobile4.png">
        <img src="documentation/ship8.png">
        <img src="documentation/truck2.png"><br/>
        <p><small>Alcune immagini di esempio del CIFAR-10: partendo da sinistra abbiamo un cane, un aeroplano,
          un'automobile, una nave e un camion.</small></p>
      </div>
      
      <p class="centrato">Per quanto riguarda la rete neurale, useremo una rete neurale
        <b><a href="frontiere.html">convoluzionale</a></b>
        utilizzando nient'altro che codice Javascript. Il massimo raggiunto da una rete neurale su questo set
        di dati è 90%, contro il 94% di immagini riconosciute da una persona (alcune figure sono ambigue e di
        difficile riconoscimento anche da parte di un essere umano).</p>
      
      <p class="centrato">Una rete neurale si trova in forte difficoltà nello svolgere questo compito e
        impiega molto ad allenarsi. Perciò si è deciso, per evitare l'
        <i><a href="overfitting.html">overfitting</a></i>, di ampliare il set di immagini modificando leggermente
        le immagini ruotandole o spostandole di al massimo 2 pixel in orizzontale e in verticale.</p>
      
      <p class="centrato">Per finire, nella fase di allenamento dividiamo le immagini in 5 gruppi di allenamento
        e 1 di test, ognuno composto da 10.000 immagini. Il gruppo di test contiene esattamente 1.000 immagini
        di ogni categoria, selezionate casualmente. Il gruppo di allenamento, invece, contiene le immagini
        rimanenti in ordine casuale, senza una quantità precisa di immagini per ogni categoria (un gruppo di
        allenamento può contenere, ad esempio, più immagini di cani che di aeroplani). Tuttavia, in totale, le
        immagini di allenamento contengo 5.000 figure per ogni categoria.</p>
      <br/>
      <p class="centrato">Passiamo ad analizzare cosa mostra questa demo. Per prima cosa, vengono mostrati
        alcuni dati significativi: quanto tempo impiega ad analizzare un'immagine e quindi ad aggiornare i
        propri parametri, il valore della funzione costo, l'accuratezza sui dati di allenamento e quella sui
        dati di validazione, il numero di esempi visti. Quindi vi sono 4 parametri modificabili: tasso di
        apprendimento, <a href="frontiere.html">momento</a>, <i>batch size</i> e tasso di decadimento dei pesi
        (analogo al tasso di <a href="regularization.html">regolarizzazione</a>). Infine, la struttura della
        rete. Ma smettiamo di parlare e passiamo alla pratica!</p>
      <br/>
      <div class="divsec">
        <div class="secpart">
          <input id="buttontp" type="submit" value="pause" onclick="toggle_pause();"/>
          <div id="trainstats"></div>

          <div id="controls">
            Learning rate: <input name="lri" type="text" maxlength="20" id="lr_input"/>
            <input id="buttonlr" type="submit" value="change" onclick="change_lr();"/>
            <br />

            Momentum: <input name="momi" type="text" maxlength="20" id="momentum_input"/>
            <input id="buttonmom" type="submit" value="change" onclick="change_momentum();"/>
            <br />

            Batch size: <input name="bsi" type="text" maxlength="20" id="batch_size_input"/>
            <input id="buttonbs" type="submit" value="change" onclick="change_batch_size();"/>
            <br />

            Weight decay: <input name="wdi" type="text" maxlength="20" id="decay_input"/>
            <input id="buttonwd" type="submit" value="change" onclick="change_decay();"/>
          </div>

          <input id="buttondj" type="submit" value="save network snapshot as JSON" onclick="dump_json();"/><br />
          <input id="buttonlfj" type="submit" value="init network from JSON snapshot" onclick="load_from_json();"/><br />
          <textarea id="dumpjson"></textarea>
          <br>

          <input id="buttonpre" type="submit" value="load a pretrained network (achieves ~80% accuracy)" onclick="load_pretrained();" style="height: 30px; width: 400px;"/><br />

        </div>
        <div class="secpart">

          <div>
            Loss:<br />
            <canvas id="lossgraph">
            </canvas>
            <br />
            <input id="buttoncg" type="submit" value="clear graph" onclick="clear_graph();"/>
          </div>
        </div>
        <div style="clear:both;"></div>
      </div>

      <h1>Instantiate a Network and Trainer</h1>
      <div>
        <textarea id="newnet" style="width:100%; height:200px;"></textarea><br />
        <input id="buttonnn" type="submit" value="change network" onclick="change_net();" style="width:200px;height:30px;"/>
      </div>

      <div class="divsec">
        <h1>Network Visualization</h1>
        <div id="visnet"></div>
      </div>

      <div class="divsec">
        <h1>Example predictions on Test set</h1>
        <div id="testset_acc"></div>
        <div id="testset_vis"></div>
      </div>

    </div>  
  </body>
</html>
